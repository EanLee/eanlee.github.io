<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>淺談壓力測試/負載測試到底要做什麼? - 伊恩的開發狂想</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7903108559996033" crossorigin=anonymous></script><meta name=description content="許多人都會想到使用負載測試/壓力測試來驗證系統的穩健度，但想要藉由測試取得特定的結果數據，就必須在測試之前，就知道測試的目標為何？"><meta property="og:title" content="淺談壓力測試/負載測試到底要做什麼?"><meta property="og:description" content="許多人都會想到使用負載測試/壓力測試來驗證系統的穩健度，但想要藉由測試取得特定的結果數據，就必須在測試之前，就知道測試的目標為何？"><meta property="og:type" content="article"><meta property="og:url" content="https://eandev.com/post/test/what-does-load-testing-do/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-04-03T07:30:13+00:00"><meta property="article:modified_time" content="2023-01-06T03:50:04+00:00"><meta itemprop=name content="淺談壓力測試/負載測試到底要做什麼?"><meta itemprop=description content="許多人都會想到使用負載測試/壓力測試來驗證系統的穩健度，但想要藉由測試取得特定的結果數據，就必須在測試之前，就知道測試的目標為何？"><meta itemprop=datePublished content="2022-04-03T07:30:13+00:00"><meta itemprop=dateModified content="2023-01-06T03:50:04+00:00"><meta itemprop=wordCount content="103"><meta itemprop=keywords content="負載測試,"><meta name=twitter:card content="summary"><meta name=twitter:title content="淺談壓力測試/負載測試到底要做什麼?"><meta name=twitter:description content="許多人都會想到使用負載測試/壓力測試來驗證系統的穩健度，但想要藉由測試取得特定的結果數據，就必須在測試之前，就知道測試的目標為何？"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap"><link rel=stylesheet href=/css/style.min.css><link rel="shortcut icon" href=/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-4HXSCXTZKZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4HXSCXTZKZ",{anonymize_ip:!1})}</script></head><body class=body><div class="container container--outer"><header class=header><div class=container><div class="logo logo--mixed"><a class=logo__link href=/ title=伊恩的開發狂想 rel=home><div class="logo__item logo__imagebox"><img class=logo__img alt=logo src=/img/placeholder.png></div><div class="logo__item logo__text"><div class=logo__title>伊恩的開發狂想</div><div class=logo__tagline>在知識大海中漂流的小船，不停追尋屬於自己的秘寶。專注於 .NET、雲端技術、系統架構、開發技巧的道、法、術。</div></div></a></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>淺談壓力測試/負載測試到底要做什麼?</h1><div class="post__meta meta"><div class="meta__item-author meta__item"><svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>伊恩</span></div><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2022-04-03T07:30:13Z>2022-04-03</time>
<time class=meta__text datetime=2023-01-06T03:50:04Z>(Last Modified: 2023-01-06)</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/%E6%B8%AC%E8%A9%A6/ rel=category>測試</a>, <a class=meta__link href=/categories/%E9%96%8B%E7%99%BC%E9%9B%9C%E8%AB%87/ rel=category>開發雜談</a></span></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#你的目的是什麼>你的目的是什麼?</a><ul><li><a href=#目的一找出單一機器穩定運行系統的最大乘載量-壓力測試>目的一：找出單一機器穩定運行系統的最大乘載量 (壓力測試)</a></li><li><a href=#目的二驗證系統架構可符合需求規格-負載測試>目的二：驗證系統架構可符合需求規格 (負載測試)</a></li><li><a href=#目的三找出目前系統運行的瓶頸以進行後續改善與優化-負戴測試效能測試>目的三：找出目前系統運行的瓶頸，以進行後續改善與優化 (負戴測試/效能測試)</a></li></ul></li><li><a href=#測試的對象測試案例的選擇>測試的對象/測試案例的選擇</a></li><li><a href=#簡單總結>簡單總結</a></li><li><a href=#延伸閱讀>延伸閱讀</a></li></ul></nav></div></div><div class="content post__content clearfix"><p>多數的時候，我們可能會將 <code>負載測試(LOAD TESTING)</code> 與 <code>壓力測試 (STRESS TESTING)</code> 混在一起討論。</p><p>無論是那種測試，都是基於特定目的的前提，去進行測試計劃的規劃。不同的測試目的，直接影響到預期的測試作法、條件以及測試系統架構。</p><p>透過測試的方式，是將系統效能加以量化。只有量化才有依據，調整或決定後續的處理方式。無論是增加機器、設定監控警告的水位，或是找出品系統瓶頸加以改善優化，</p><h2 id=你的目的是什麼>你的目的是什麼?</h2><p>今天來聊聊負載測試到底要做什麼？經常聽到，為了確保軟體系統的穩定度，所以想要藉由負載測試/壓力測試的方式，進行系統的驗證。</p><p>但有趣的是，參與負載測試或壓力測試的成員中，有多少人清楚知道此次測試的目的為何?預期得到何種結果？測試的結果會如何使用？要測試到什麼樣的程度，才算完成？</p><p>為了避免在一無所知的情境下，採用無效的測試方法或過多無用的測試案例。在測試開始前，一定要非常明確的了解，壓測的目的為何？期望藉由測試得到的何種問題的答案？</p><p>隨著你的問題與目的不同，壓力測試所規劃的測試系統架構、測試案例、準備假資料、作法等等，都會有所不同，無法以一概全。</p><h3 id=目的一找出單一機器穩定運行系統的最大乘載量-壓力測試>目的一：找出單一機器穩定運行系統的最大乘載量 (壓力測試)</h3><p>有時，當需要購買新的機器或在雲端開啟新的機器時，有時會遇到有人會詢問，這台機器可以支援多少人同時使用？多大的流量？機器的規格是否可以符合需求？等等。</p><p>在沒有數據資料支撐的前提下，很難去評估目前的機器配置到底可以支撐系統到什麼樣的程度。</p><p>此時，測試的重點在於 <code>壓力測試 (STRESS LOADING)</code>，對於待測目標或系統，藉由不斷的增加壓力的強度，直到系統癱瘓或發生大量異常。並將這些壓力強度、系統當下的運行效能加以量化，找出當下機器可承受的瓶頸以及最大容載量。</p><p>假若，此時注重的重點，是單一台機器的效能與情況，測試系統架構圖上會盡可能的讓測試的焦點集中在一台機器。同時，系統中的快取機制，資料庫的存取架構(例如讀取分離)等，都會列入評估範圍。</p><p><figure><center><img src=../../images/stress_test_single_test_arch.png alt=單一機器測試架構><figcaption>單一機器測試架構</figcaption></center></figure></p><p>舉例來說，若是今天的測試目的，是想要找出系統在沒有 cache 的情況下，在單一台機器，可承載的請求數量上限為何？同時到達上限後，遇到系統瓶頸時，問題點是發生在軟體本身？資料庫回應逾時？資料庫 I/O 過高？</p><p>此時觀察的不僅僅是請求數量的級別、平均請求響應時間、請求的成功率。此外，也需要觀察受測機器中，CPU 與記憶體的使用率，硬碟 I/O 的存取量。這時候我們才能清楚地去了解，瓶頸發生的位置在哪裡。</p><p>唯有收集完這些相關資訊，針對後續的策略規劃才能有所依據。不管是要擴增機器數量、增加控制的水位值或是系統調整等等。</p><h3 id=目的二驗證系統架構可符合需求規格-負載測試>目的二：驗證系統架構可符合需求規格 (負載測試)</h3><p>往往會聽到某某系統可以支援多少人同時上線，或是軟體的需求規格書中，明確要求必須可以支撐多少人同時使用。那麼我們要如何驗證系統是符合要求的呢？</p><p>或者，為了驗證在大量請求的情境下，例如同時 1000 人、2000 人、或 5000 人以上，同時進行交易時，系統所處理的數據資料一切正確。</p><p>藉由 <code>負載測試 (LOAD TESTING)</code> 來驗證大量請求處理的時候，是否符合需求規格書內可承載的最大請求數，或者是用來驗證在龐大交易量的情況下，資料本身是否有發生異常，以確保後續上線之後，重要的資料不會出現異常錯誤。</p><p>若是前者，測試系統架構需要盡可能地貼近實際的系統架構。若是為了驗證資料的正確性，需要額外在初期就規劃好資料驗證的方式。</p><h3 id=目的三找出目前系統運行的瓶頸以進行後續改善與優化-負戴測試效能測試>目的三：找出目前系統運行的瓶頸，以進行後續改善與優化 (負戴測試/效能測試)</h3><p>當系統運行已經有很長的時間後，有人反應系統效能不佳時，希望對現有系統進行優化。</p><p>在進行系統的改善與優化之前，必須先找出目前軟體遭遇的瓶頸。藉由 <code>效能測試(PERFORMANCE TESTING)</code> 將系統效能加以量化，同時<strong>收集、統計、分析</strong>測試過程中的數據資料，試圖找出系統運行間，系統在每個服務之間的轉換、請求響應時間，資料庫的存取耗費時間等等，以便彙整造成瓶頸的問題清單。</p><p>此外，若測試的情境案例中，處理流程涉及第三方服務，需要考量第三方服務的效能，是否是壓力測試所在意的地方？</p><p>假若想要確認第三方服務的效能，是否是影響系統效能的主要瓶頸點？此時就必須將第三方服務列入測試的範圍內。要特別注意，若測試範圍包括到第三方服務，需特別小心，並需要事前通知第三方服務的供應商，避免造成後續一連串額外的問題。</p><p>假若第三方服務的效能不是關注的重點，則會針對軟體內呼叫第三方服務的部分，使用 Mock API 回傳假資料的方式，減少第三方服務對測試結果的影響。</p><p>舉例來說，若某個測試案例中，資料處理過程中，將會依序與使用三個第三方服務 <code>Service 1</code>、<code>Service 2</code>、<code>Service 3</code> 。</p><p><figure><center><img src=../../images/stress_test_3rd_party_process_before.png alt=測試與第三方服務><figcaption>測試與第三方服務</figcaption></center></figure></p><p>但 <code>Service 1</code>、<code>Service 3</code> 不是此時測試的考量重點，就會進行<strong>系統內相關區塊的改寫</strong>或是<strong>指向 Mock Service</strong>，減少非必要因素的影響。</p><p><figure><center><img src=../../images/stress_test_3rd_party_process_after.png alt=測試與第三方服務><figcaption>測試與第三方服務</figcaption></center></figure></p><p>當測試的目的是為系統改善優化，那一定要有一個基準值，基準值不僅僅是規劃優化項目的參考資訊，同時也用來比對優化前後差異。這個基準值可能是上一次測試的結果資訊，也可能是新收集到的資訊。</p><p>在這過程中，最花時間的，莫過於收集、分析系統內流程中各階段所耗費時間、資源。這個部分有很多的方式都可以收集到，可以使用 log 收集，也可以採用 Dump 的方式，或是 Application Insight 監控所收集到的系統資訊等等。</p><p>接著針對這些資料加以統計分析，就會找到我們所最在意的瓶頸問題，這時候我們會針對收集到的瓶頸問題嚴重性加以排序，列出優化的優先順序，因為我們不可能把全部的瓶頸都調教到非常理想的狀態，根據二八法則，只要處理最重要的兩成，就可以得到 80% 的優化結果。</p><h2 id=測試的對象測試案例的選擇>測試的對象/測試案例的選擇</h2><p>我們常常聽到有人說壓力測試/負載測試不可能全部都測試，只要測試最重要的功能就行。</p><p>但可是最重要的功能是什麼？到底要如何麼決定？是工程師決定測試最複雜的部分嗎?還是業務覺得功能最重要？還是想到測什麼就測什麼？其實這個沒有明確的答案，不同利益關係人的回答都會不一樣。</p><p>個人的觀點是，在還沒有特定目的和目標之前，從商業情境下手，什麼是最重要的業務情境，那就是最重要的測試情境，接著再針對這個情境下去分析測試方式。</p><p>若是有很明確的測試目的，就直接針對目的進行測試，</p><p>舉例來說，若今天想要測試購物車結帳流程目前的瓶頸點是什麼。那麼就不會去考量購物車以外的測試案例，更著重於購物車結帳流程中，各階段的效能、與哪些服務有關係、結帳後的資料驗證等等。</p><h2 id=簡單總結>簡單總結</h2><p>無論基於何種目的去進行壓力測試/負載測試/效能測試，都必須清楚知道測試的目的與追尋的答案。不同的目的，會影響到測試的案例，測試的架構，是否需要調整程式，都會有所不同。</p><p>測試的目的，說穿了就是對軟體系統目前可支援的層級，以及效能加以數值量化，便於後續評估應對策略。是要加開機器？安排資源，進行系統改善與優化？安排自動化系統監控通知的水位。</p><h2 id=延伸閱讀>延伸閱讀</h2><ol><li><a href=https://k6.io/docs/test-types/introduction/>Introduction (k6.io)</a></li><li><a href=https://eandev.com/post/test/talking-testing-report/>淺談負載測試/壓力測試/效能測試報告</a></li></ol></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><a class=tag href=/tags/%E8%B2%A0%E8%BC%89%E6%B8%AC%E8%A9%A6/ rel=tag>負載測試</a></ul></div></footer><hr><div><p>文章內容均為個人學習記錄、心得與認知，若任何謬誤或建議，歡迎直接留言討論，一同成長。</p></div><iframe class=LikeCoin src="https://button.like.co/in/embed/wosilee/button?referrer=https%3a%2f%2feandev.com%2fpost%2ftest%2fwhat-does-load-testing-do%2f" height=200 width=100% frameborder=0></iframe></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/post/software/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC%E9%9C%80%E6%B1%82%E9%87%90%E6%B8%85/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>軟體開發需求釐清</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/post/projectmanagement/%E5%BE%9E%E6%B6%88%E9%99%A4%E9%81%8A%E6%88%B2%E5%AD%B8%E5%88%B0%E7%9A%84%E5%B0%88%E6%A1%88%E7%AE%A1%E7%90%86%E4%BA%8C%E4%B8%89%E4%BA%8B/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>從消除遊戲學到的專案管理二三事</p></a></div></nav><section class=comments><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//eanblog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2023 伊恩軟體技術學習與分享.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div></body></html>