<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>簡述程式碼品質與優化方向 - 伊恩的開發狂想</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7903108559996033" crossorigin=anonymous></script><meta name=description content="程式碼的品質大多情況下，由開發人員的基礎功來決定"><meta property="og:title" content="簡述程式碼品質與優化方向"><meta property="og:description" content="程式碼的品質大多情況下，由開發人員的基礎功來決定"><meta property="og:type" content="article"><meta property="og:url" content="https://eanlee.github.io/post/series/optimize_code_quality/coding_suggest/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-06-21T15:06:43+00:00"><meta property="article:modified_time" content="2022-07-29T09:26:17+00:00"><meta itemprop=name content="簡述程式碼品質與優化方向"><meta itemprop=description content="程式碼的品質大多情況下，由開發人員的基礎功來決定"><meta itemprop=datePublished content="2022-06-21T15:06:43+00:00"><meta itemprop=dateModified content="2022-07-29T09:26:17+00:00"><meta itemprop=wordCount content="871"><meta itemprop=keywords content="Refactor,"><meta name=twitter:card content="summary"><meta name=twitter:title content="簡述程式碼品質與優化方向"><meta name=twitter:description content="程式碼的品質大多情況下，由開發人員的基礎功來決定"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-4HXSCXTZKZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4HXSCXTZKZ",{anonymize_ip:!1})}</script><link href=/css/syntax.min.css rel=stylesheet><link href=/css/copy-to-clipboard.min.css rel=stylesheet></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class="logo logo--mixed"><a class=logo__link href=/ title=伊恩的開發狂想 rel=home><div class="logo__item logo__imagebox"><img class=logo__img src=/img/placeholder.png></div><div class="logo__item logo__text"><div class=logo__title>伊恩的開發狂想</div><div class=logo__tagline>在知識大海中漂流的小船，不停追尋屬於自己的秘寶。專注於 .NET、雲端技術、系統架構、開發技巧的道、法、術。</div></div></a></div><div class=divider></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>簡述程式碼品質與優化方向</h1><div class="post__meta meta"><div class="meta__item-author meta__item"><svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>伊恩</span></div><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2022-06-21T15:06:43Z>2022-06-21</time>
<time class=meta__text datetime=2022-07-29T09:26:17Z>(Last Modified: 2022-07-29)</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/%E9%96%8B%E7%99%BC%E9%9B%9C%E8%AB%87/ rel=category>開發雜談</a></span></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#程式碼的易讀性>程式碼的易讀性</a><ul><li><a href=#程式的壞味道code-small與改善>程式的壞味道(Code small)與改善</a></li><li><a href=#工欲善其事必先利其器>工欲善其事、必先利其器</a></li></ul></li><li><a href=#隱藏在原始碼的小幫手註解>隱藏在原始碼的小幫手~註解</a></li><li><a href=#回顧>回顧</a></li><li><a href=#作法分享>作法分享</a></li><li><a href=#延伸閱讀>延伸閱讀</a><ul><li><a href=#註解>註解</a></li><li><a href=#refactor>Refactor</a></li></ul></li></ul></nav></div></div><div class="content post__content clearfix"><blockquote><p><a href=https://eanlee.github.io/post/series/optimize_code_quality/foreword/#基礎篇>持續優化程式碼品質</a> 基礎篇</p></blockquote><p>在開發時，為了快速或是避免麻煩，可能會用簡單的代號，例如 <code>aa</code> 這種名稱，來暫時做為變數的名稱。這無可厚非，但是&mldr;假若在完成該功能後，未能進行程式的整理。</p><p>也許在三個月後的某一天，程式有需求變動，不管是要修改自己開發的程式，還是要維護前人遺留下來的軟體。在一番苦戰，好不容易找到要修改變動的程式區塊。</p><p>看著各種無意義的命名、複雜且混亂的程式邏輯，只能苦苦的思考，為什麼當初會這樣寫？這個變數是什麼意義？動作背後的用意？邊改寫程式，邊幹譙當初寫下這段程式的人。</p><h2 id=程式碼的易讀性>程式碼的易讀性</h2><p>將以前處理過的研究生專題的原始碼為例。當需要對這段程式進行維護或修改，事前需要花費額外大量的時間，用於理解程式碼所代表的意義。爾後才能開始進行修改。</p><p>為了撰寫程式的效率，我們應該盡可能讓程式碼呈現更高的意圖性與可讀性，讓後續接手的人可以更快速的定位焦點所在。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1</span><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span>[,] ga(<span style=color:#66d9ef>int</span>[,,] im_1, <span style=color:#66d9ef>int</span>[,,] im2_1)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3</span><span>    <span style=color:#66d9ef>int</span> h = im_1.GetLength(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4</span><span>    <span style=color:#66d9ef>int</span> w = im_1.GetLength(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6</span><span>    <span style=color:#66d9ef>int</span>[,] k = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>[<span style=color:#ae81ff>2</span>, ggg];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7</span><span>    <span style=color:#66d9ef>int</span>[] k1 = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>[ggg];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8</span><span>    <span style=color:#66d9ef>int</span>[,] k2 = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>[<span style=color:#ae81ff>3</span>, ggg];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10</span><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> ie = <span style=color:#ae81ff>0</span>; ie &lt; ggg; ie++){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11</span><span>        k1[ie] = <span style=color:#ae81ff>1000</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14</span><span>    Random innerRnd = <span style=color:#66d9ef>new</span> Random(Guid.NewGuid().GetHashCode());
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15</span><span>    Random innerRnd1 = <span style=color:#66d9ef>new</span> Random(Guid.NewGuid().GetHashCode());
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17</span><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j = <span style=color:#ae81ff>0</span>; j &lt; ggg; j++){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18</span><span>        k[<span style=color:#ae81ff>0</span>, j] = (innerRnd.Next(<span style=color:#ae81ff>255</span>)) - Val01;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19</span><span>        k[<span style=color:#ae81ff>1</span>, j] = (innerRnd1.Next(<span style=color:#ae81ff>255</span>)) - Val02;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22</span><span>    progressBar1.Maximum = <span style=color:#ae81ff>26</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24</span><span>    <span style=color:#66d9ef>int</span> iu, ju, temp, temp1, temp2, score = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26</span><span>    <span style=color:#66d9ef>while</span> (score &lt;= <span style=color:#ae81ff>25</span>){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27</span><span>        score = score + <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28</span><span>        progressBar1.Value = score;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30</span><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> score1 = <span style=color:#ae81ff>0</span>; score1 &lt;= <span style=color:#ae81ff>15</span>; score1++){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31</span><span>            <span style=color:#66d9ef>int</span>[,] k111 = k;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32</span><span>            Random innerRnd8 = <span style=color:#66d9ef>new</span> Random(Guid.NewGuid().GetHashCode());
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33</span><span>            <span style=color:#66d9ef>int</span> a1 = innerRnd8.Next(ggg);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34</span><span>            Random innerRnd9 = <span style=color:#66d9ef>new</span> Random(Guid.NewGuid().GetHashCode());
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35</span><span>            <span style=color:#66d9ef>int</span> a2 = innerRnd9.Next(ggg);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37</span><span>            <span style=color:#66d9ef>double</span> rrr = _RRR(k[<span style=color:#ae81ff>0</span>, a1], k[<span style=color:#ae81ff>1</span>, a1], im_1, im2_1);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38</span><span>            <span style=color:#66d9ef>double</span> rrr_1 = _RRR(k[<span style=color:#ae81ff>0</span>, a2], k[<span style=color:#ae81ff>1</span>, a2], im_1, im2_1);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40</span><span>            <span style=color:#66d9ef>if</span> (rrr &gt; rrr_1){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41</span><span>                k[<span style=color:#ae81ff>0</span>, a1] = k[<span style=color:#ae81ff>0</span>, a2];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42</span><span>                k[<span style=color:#ae81ff>1</span>, a1] = k[<span style=color:#ae81ff>1</span>, a2];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43</span><span>                k1[a2] = Convert.ToInt32(rrr_1);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44</span><span>                k1[a1] = Convert.ToInt32(rrr_1);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46</span><span>            <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (rrr &lt;= rrr_1){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47</span><span>                k[<span style=color:#ae81ff>0</span>, a2] = k[<span style=color:#ae81ff>0</span>, a1];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48</span><span>                k[<span style=color:#ae81ff>1</span>, a2] = k[<span style=color:#ae81ff>1</span>, a1];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49</span><span>                k1[a1] = Convert.ToInt32(rrr);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50</span><span>                k1[a2] = Convert.ToInt32(rrr);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53</span><span>            <span style=color:#75715e>/***********************************
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54</span><span><span style=color:#75715e>            //  略過部份程式碼內容
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55</span><span><span style=color:#75715e>            ***********************************/</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57</span><span>            <span style=color:#66d9ef>for</span> (iu = <span style=color:#ae81ff>0</span>; iu &lt; ggg; iu++)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58</span><span>            {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59</span><span>                <span style=color:#66d9ef>for</span> (ju = <span style=color:#ae81ff>1</span>; ju &lt; ggg; ju++)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60</span><span>                {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61</span><span>                    <span style=color:#66d9ef>if</span> (k2[<span style=color:#ae81ff>2</span>, ju - <span style=color:#ae81ff>1</span>] &gt; k2[<span style=color:#ae81ff>2</span>, ju])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62</span><span>                    {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63</span><span>                        temp = k2[<span style=color:#ae81ff>2</span>, ju - <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64</span><span>                        temp1 = k2[<span style=color:#ae81ff>0</span>, ju - <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65</span><span>                        temp2 = k2[<span style=color:#ae81ff>1</span>, ju - <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67</span><span>                        k2[<span style=color:#ae81ff>2</span>, ju - <span style=color:#ae81ff>1</span>] = k2[<span style=color:#ae81ff>2</span>, ju];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68</span><span>                        k2[<span style=color:#ae81ff>0</span>, ju - <span style=color:#ae81ff>1</span>] = k2[<span style=color:#ae81ff>0</span>, ju];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69</span><span>                        k2[<span style=color:#ae81ff>1</span>, ju - <span style=color:#ae81ff>1</span>] = k2[<span style=color:#ae81ff>1</span>, ju];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71</span><span>                        k2[<span style=color:#ae81ff>2</span>, ju] = temp;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72</span><span>                        k2[<span style=color:#ae81ff>0</span>, ju] = temp1;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73</span><span>                        k2[<span style=color:#ae81ff>1</span>, ju] = temp2;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74</span><span>                    }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75</span><span>                }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78</span><span>            <span style=color:#66d9ef>int</span> ddd1 = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79</span><span>            <span style=color:#66d9ef>for</span> (iu = <span style=color:#ae81ff>0</span>; iu &lt; gggzz; iu++){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80</span><span>                ddd1 = ddd1 + (k2[<span style=color:#ae81ff>2</span>, iu]);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83</span><span>            <span style=color:#66d9ef>int</span> ddd_1 = Convert.ToInt16(ddd1 / gggzz);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84</span><span>            dddd_2 = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86</span><span>            <span style=color:#66d9ef>for</span> (iu = <span style=color:#ae81ff>0</span>; iu &lt; gggzz; iu++)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87</span><span>            {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88</span><span>                dddd_2 = dddd_2 + Math.Abs(ddd_1 - k2[<span style=color:#ae81ff>2</span>, iu]);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92</span><span>        <span style=color:#66d9ef>if</span> (Math.Sqrt(dddd_2) &lt;= <span style=color:#ae81ff>0.005</span> &amp;&amp; k2[<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>] &lt;= <span style=color:#ae81ff>5</span>){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93</span><span>            score = <span style=color:#ae81ff>26</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94</span><span>            progressBar1.Value = <span style=color:#ae81ff>26</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98</span><span>    <span style=color:#66d9ef>int</span> gg = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99</span><span>    <span style=color:#66d9ef>int</span> gg1 = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100</span><span>    <span style=color:#66d9ef>int</span>[,] good = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>[<span style=color:#ae81ff>2</span>, ggg];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102</span><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j111 = <span style=color:#ae81ff>0</span>; j111 &lt; gggzz; j111++){
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103</span><span>        gg = gg + k2[<span style=color:#ae81ff>0</span>, j111];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104</span><span>        gg1 = gg1 + k2[<span style=color:#ae81ff>1</span>, j111];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107</span><span>    <span style=color:#66d9ef>int</span> x_new = Convert.ToInt16(gg / gggzz);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108</span><span>    <span style=color:#66d9ef>int</span> y_new = Convert.ToInt16(gg1 / gggzz);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110</span><span>    <span style=color:#66d9ef>int</span>[,] x_y = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>[<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112</span><span>    x_y[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>] = x_new;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113</span><span>    x_y[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>] = y_new;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114</span><span>    <span style=color:#66d9ef>return</span> x_y;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115</span><span>}
</span></span></code></pre></div><p>不易閱讀的因素，大致上包含</p><ul><li>大量無意義的變數名</li><li>區域變數與全域變數無法識別</li><li>程式的邏輯與介面高耦合性</li><li>函數名稱與實際動作內容有差異</li></ul><h3 id=程式的壞味道code-small與改善>程式的壞味道(Code small)與改善</h3><p>造成程式碼不易閱讀的因素有很多，但最常見的就是<strong>命名行為不確實</strong>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-C# data-lang=C#><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> score1 = <span style=color:#ae81ff>0</span>; score1 &lt;= <span style=color:#ae81ff>15</span>; score1++){
</span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>        <span style=color:#66d9ef>int</span>[,] k111 = k;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>        Random innerRnd8 = <span style=color:#66d9ef>new</span> Random(Guid.NewGuid().GetHashCode());
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>        <span style=color:#66d9ef>int</span> a1 = innerRnd8.Next(ggg);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>        Random innerRnd9 = <span style=color:#66d9ef>new</span> Random(Guid.NewGuid().GetHashCode());
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>        <span style=color:#66d9ef>int</span> a2 = innerRnd9.Next(ggg);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>
</span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>        <span style=color:#66d9ef>double</span> rrr = _RRR(k[<span style=color:#ae81ff>0</span>, a1], k[<span style=color:#ae81ff>1</span>, a1], im_1, im2_1);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>        <span style=color:#66d9ef>double</span> rrr_1 = _RRR(k[<span style=color:#ae81ff>0</span>, a2], k[<span style=color:#ae81ff>1</span>, a2], im_1, im2_1);
</span></span></code></pre></div><p>首先發現的是<strong>不具代表性的變數名稱</strong> <code>k</code>，看到的當下，很難知道它所代表意思。只能回頭查看 <code>k</code> 這個物件，它儲存了什麼資訊、它有什麼用途。</p><p>回頭找到 <code>k</code> 的定義，這才發現它是一組用於儲存樣本資料的二維陣列，長度為 <code>ggg</code> 代表的取樣的數量。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> ggg = <span style=color:#ae81ff>40</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>    
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span>[,] ga(<span style=color:#66d9ef>int</span>[,,] im_1, <span style=color:#66d9ef>int</span>[,,] im2_1)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>    <span style=color:#66d9ef>int</span>[,] k = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>[<span style=color:#ae81ff>2</span>, ggg];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>    ...
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>}
</span></span></code></pre></div><p>花費在 <strong>查詢無意義命名的變數的用途與資訊</strong> 的時間，就是變向的浪費寶貴的開發時間。為了提升可讀性，並避免每次看到 <code>變數 k</code> 就要再次確認背後的用意，所以將其更名為代表性意義的名稱。</p><p>另外，<code>ggg</code> 為類別的成員(Field)，但在程式碼中，無法直接辨識變數的屬於區域變數、或是類別成員。實務上，當類別成員與區域變數無法區分，可能會出現變數誤用的情況，導致非預期的 BUG。</p><p>針對兩個問題，進行調整。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> _sampleAmount = <span style=color:#ae81ff>40</span>;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>    
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span>[,] ga(<span style=color:#66d9ef>int</span>[,,] im_1, <span style=color:#66d9ef>int</span>[,,] im2_1)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>    <span style=color:#66d9ef>int</span>[,] sampleGroup = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>[<span style=color:#ae81ff>2</span>, _sampleCount];
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>    ...
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>}
</span></span></code></pre></div><p>再來，來探討 <code>int _RRR(int _X, int _Y, int[, ,] im_1, int[, ,] im2_1)</code> 幾個不易閱讀或理解問題點。</p><ul><li>難以判讀的函數名稱: <strong>無法從函數名稱直接得知回傳物件的意義。</strong></li><li>不具代表性的函數參數名稱: <strong>無法直接經由參數的名稱，進一步瞭解到參數的意義，可能會造成需要額外的說明文件或註解。</strong></li></ul><p>進一步理解 <code>_RRR(...)</code> 的功能，得知該方法的目的為，找出兩張影像在特定座標位置的誤差量。在知道方法的功用後，將方法名稱與參數進行調整為 <code>CalculateImageOverlapError(...)</code> ，以便更快速了解函數的功能與目標。</p><p>最後，再來看一再重複出現，但功能相同的程式碼。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>    Random innerRnd8 = <span style=color:#66d9ef>new</span> Random(Guid.NewGuid().GetHashCode());
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>    <span style=color:#66d9ef>int</span> a1 = innerRnd8.Next(ggg);
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>    Random innerRnd9 = <span style=color:#66d9ef>new</span> Random(Guid.NewGuid().GetHashCode());
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>    <span style=color:#66d9ef>int</span> a2 = innerRnd9.Next(ggg);
</span></span></code></pre></div><p>仔細觀察背後的含義，就只是為了取到特定範圍內的亂數種子，所以可以將重複的部份抽取為一個方法 <code>GetRnadomSeed(int maxRange)</code>，以達到重複使用的結果。</p><p>上述這些將變數與方法進行更名，方法的抽取，都是重構的一種行為。<strong>重構</strong> 這件事，其實沒有那麼困難，甚至可以說，重構這個行為本身就融入在開發的過程中。</p><p>只要在不影響外部行為的前提下，修改內部的程式結構，讓其更加容易閱讀、維護與變更。所以只要符合上面提到的原則，都可以稱之為重構。</p><h3 id=工欲善其事必先利其器>工欲善其事、必先利其器</h3><p>但是重構的作業，有時步驟很瑣碎或煩瑣，但這些問題，許多的 IDE 已內建方便的功能，讓開發者可以快速的完成重構，或是快速定位要修改的位置。</p><p>就算這樣，也是很難想像差異。用情境故事或許更容易可以理解差異。</p><p>想像一下，一早帶著愉快的心情走進辦公室，才剛坐下來，椅子還沒有坐熱，就突然收到臨時告知，要增加一個新的功能項目，而且後天早上的就要 DEMO。</p><p>幹譙歸幹譙，還是認命的去趕工。</p><h4 id=善用工具的開發者>善用工具的開發者</h4><p>小偉是一個很怕麻煩，而且厭倦高重覆性且沒效率的做事方式，所以他熟記開發環境中<strong>常用的快捷鍵</strong> 與<strong>好用的功能</strong> ，並在使用的 IDE 中，安裝了許多便利的 <strong>輔助工具</strong>。</p><p>小偉接受任務後，快速的評估了一下該項目的變動範圍，構想一下如何實作，開始撰寫程式碼後，除非是必需使用滑鼠的地方，否則小偉的手幾乎沒有離開鍵盤。</p><p>開發過程中，大量使用 IDE 的快捷鍵與輔助工具提供的功能。同時，針對程式內重要的區塊，撰寫對應的單元測試，當天下班前，就將功能雛形實作的差不多了。</p><p>隔天，小偉將匆忙完成的程式，進行最後的校調與測試。確定功能無誤後，將程式碼上版控。隨後，使用輔助工具，對程式碼進行快速的重構與整理，完成後，再上版控。</p><p>此時，午休鈴剛剛好響了起來，小偉伸了伸腰，心想又完成了一個任務。</p><h4 id=初級開發者>初級開發者</h4><p>小刀是一個很認真的人，但是從來沒有想過要去使用快捷鍵，只使用原生的 IDE 功能，未安裝任何的輔助工具。</p><p>同樣的情境，小刀接受任務後，快速的評估了一下該項目的變動範圍，構想一下如何實作，開始撰寫程式碼後，所有需要使用IDE的功能，都使用滑鼠去點擊。</p><p>相對的，開發的過程中，就看小刀的手不停的在鍵盤與滑鼠間移動，到了下班時間，發現進度只到一半，決定多留下來多寫一兩個小時。</p><p>隔天，小刀持續全心全力的趕工中，到了下班時間，發現還差一點，只好再留下來加班。到晚上八點，好不容易將項目完成，小刀拖著疲累的身體回家的路上，只想好好休息。</p><hr><p><strong>對使用的 IDE 有多熟、準備的工具有多少，完全可以反應在開發的效率與結果。</strong></p><p>不要以為上面的情境不可能發生，上面的例子都是小弟親自遇過的案例。做 SOHO 的期間，在拜訪客戶時，還曾經看過用記事本來寫韌體的強者(小弟大概一輩子都做不到)。這個世界很大，什麼事都可能發生。</p><p>如果看倌有機會看到高手寫程式，就只會看到他們的螢幕畫面切來切去，利用輔助工具來自動補齊或產生特定的程式碼區塊，撰寫速度跟飛的一樣。</p><p>網路上，也有很多熱心的朋友，會推薦或開發好用的輔助工具，都可以去試用看看，找到屬於自己的秘寶。懂得使用工具，才會減輕工作量，才有機會持續精進自己。</p><h2 id=隱藏在原始碼的小幫手註解>隱藏在原始碼的小幫手~註解</h2><p>開發者不可能永遠都是寫新的專案，一定會遇到舊程式的維護或調整。在接手前人的程式時，有可能會發生以下幾種情況，</p><ul><li>基本上不存在 IDE 自行產生的註解以外的註解。</li><li>滿滿的註解起來的程式碼，但是不確定這些註解有沒有用途。</li><li>完全不明白意思的註解。</li></ul><p>軟體開發過程中，為了修改程式邏輯，經常會出現將原本的程式碼區段註解，避免之後還有派上用場旳時間。但是在完成開發後，整理程式碼時，應該清除將這些暫時註解掉的程式碼。</p><p>若程式碼己經具有高閱讀性，某方面而言，是可以替代一定程度的註解。但是註解可沒有那麼單純。<strong>註解中，有時候，會特別記錄重要的資訊，而這些資訊，正好是程式碼本身無法表示出來的。</strong></p><p>像是特殊的業務邏輯、臨時止血用的短暫解法，因為特定因素所採用特定的做法，請務必特別註明，讓後面的人知道，避免在維護程式時，將功能改壞。為了未來的自己，或是後續接手的人，請養成註解說明的習慣。</p><p>在 <em>Clean Code</em> 一書中，關於註解的章節中，提到好的程式碼，應該程式碼本身就是最好的註解，雖然無法避免使用註解進行說明，但應該該竭盡所能，讓註解減少到最低。對於這個說法，很多人抱持的不同看法，算是滿有爭議的說法。但也很值得我們去思考的這個問題。</p><p>另外要注意的是註解干擾，例如<code>無用的註解</code>、<code>無法解讀的註解</code>，這部份務必上版或釋出前，請刪除無意義或無用的註解。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-C# data-lang=C#><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> StatisticCostAmount(...)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>    ...
</span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    <span style=color:#75715e>// 做法一</span>
</span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    <span style=color:#75715e>// .....</span>
</span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    <span style=color:#75715e>// .....</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    <span style=color:#75715e>// 解法二</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>    <span style=color:#66d9ef>foreach</span>(<span style=color:#66d9ef>var</span> item <span style=color:#66d9ef>in</span> items)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>        ...
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>       
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>           
</span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>        <span style=color:#75715e>// 2017/5/12 修改</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>        ...        
</span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>    <span style=color:#75715e>// Console.WriteLine($&#34;total={total}&#34;)</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>}
</span></span></code></pre></div><ul><li><p>無用的註解</p><p>開發的過程中，有時為了 DEBUG，可能會在程式碼中，插入除錯用的程式碼。</p><p>但解決完問題後，被 comment out 的區塊卻保留下來，如上面範例中出現的 <code>Console.WriteLine(...</code>)`，基本上，在完成除錯後，應該要刪除這些有特定用途的程式碼。</p></li><li><p>食之無味、棄之可惜的註解</p><p>再者，常見發生在使用檔案壓縮做版控時，因為特定因素，改寫原本正常運行的的程式寫法。同時，為方便後續回頭來查詢原本寫法，所以將本來的寫法保留下來。</p><p>例如範例中的<code>作法一</code> 的註解區塊。事實上，如果修改後的程式沒有發生任何問題，回來查看被註解掉的程式碼機會，基本上無限趨近於 0。</p><p>其實，若有養成使用版控軟體的版控習慣，例如 Git。因為原本寫法已保留在之前的記錄中，所以建議直接移除，保持程式碼的清潔，以提升閱讀性。若是一定要保留在程式碼中，應該針對註解的部份，說明保留下來的原因。</p></li><li><p>無法解讀的註解</p><p>看到 <code>// 2017/5/12 修改</code> 這句註解，應該是滿頭霧水，註解的用意是？</p><ul><li><p><strong>單純表示 2017/5/12 修改的?</strong></p><p>如果只是單純註明這段程式碼修改的日期，那這個註解本身是沒有任何意義的，應該盡可能避免。</p></li><li><p><strong>告知協同開發的伙伴說明程式碼己經修改？</strong></p><p>一般而言，如果需要協同開發程式，表示軟體有一定的規模。請愛用<strong>版本控制軟體</strong>，版控軟體可以更有效的比對出異動的程式碼。</p></li><li><p><strong>修改程式碼是因為需求變動？</strong></p><p>如果是因為臨時性的需求變動，特別標註修改日期，那麼應該連帶說明修改的原因。以確保其他人看到這段程式碼時，第一時間可以明白修改的原因。</p></li></ul></li></ul><h2 id=回顧>回顧</h2><p>持續優化碼的第一步，就是<strong>自我要求程式碼具有可有高閱讀性</strong>。這件事，一開始一定是困難的。因為這己經跟你原本的工作習慣有所差異。至少要花上三個月左右來磨合，工作上才會比較順手。</p><ul><li><p>撰寫新功能</p><p>當我們現在撰寫新的功能時，不管是在宣告<strong>變數</strong>、<strong>函數名稱</strong>、<strong>類別名稱</strong>等等，都需要事先設想它的功能用途。然後，取一個符合該功能用途的名稱。</p></li><li><p>維護現有程式</p><p>當 Legacy Code 需要維護修改時，假若程式閱讀性不佳。只要<strong>針對要修改部份的程式區段，進行最基本的重構—改名</strong>，讓經手過的程式，變成具有閱讀性的好程式碼。不管是要持續負責維護的自己，還是未來接手的同事，都是好事。</p></li><li><p>適時重構程式碼</p><p>寫程式就像是打造一件藝術品，一定要經過不斷的雕琢後，才能散發出他內在的光芒。沒有人可以一開始就寫出完美而美麗的程式碼，必定隨著開發過程中，不斷的重構，才能慢慢的產生<strong>高閱讀性</strong>、<strong>高維護性</strong>、<strong>高修改性</strong>的程式碼。</p></li><li><p>重構的保護傘—單元測試</p><p>很多人之所以不重構，主要的原因之一，就是擔心在執行軟體功能的優化或重構時，會將功能改壞，造成多做多錯、不做不錯。為避免這情況，可使用像 <strong>單元測試</strong> 等方法，確保動作的正常。</p></li><li><p>重覆使用程式碼</p><p>很多工程師，為了快速達到開發的目標，可能會將相同的程式碼 Copy/Paste 到多個地方。但是，萬一這個部份的程式碼要修改，很容易發生…以為全部的程式碼都有改到，結果偏偏漏改一個地方。善用開發使用程式語言特性，盡可能程式區塊被重複使用。以達到<strong>高維護性</strong>與<strong>高修改性</strong>。</p></li></ul><h2 id=作法分享>作法分享</h2><ul><li>將<strong>資料來源</strong>、<strong>商業邏輯</strong>、<strong>使用者介面</strong>切割。</li><li>將<strong>相同職責</strong>的函數，全部封裝於同一個類別之中。</li><li>開發功能中，以<strong>實現功能為最優先事項</strong>。完成一個函數功能後，立即確認是否有要重構的部份。</li><li>相近的功能，評估是否可以合併、重構為獨立的函數。盡可能的達到<strong>重覆使用程式碼</strong>的目標。</li><li>針對<strong>高使用性</strong>、<strong>高重要性</strong>的的函數功能，撰寫對應的<strong>單元測試</strong>。</li><li>完成程式開發後，再 <strong>Code review</strong>。</li></ul><h2 id=延伸閱讀>延伸閱讀</h2><h3 id=註解>註解</h3><ul><li><a href=https://ithelp.ithome.com.tw/articles/10191221>『用註解補足程式碼易讀性？』 &ndash; 論註解的是與非</a></li><li><a href=https://blog.taiwolskit.com/best-practices-for-writing-code-comments>技術翻譯 - 編寫程式註解的最佳實踐</a></li></ul><h3 id=refactor>Refactor</h3><ul><li><a href=https://www.tenlong.com.tw/products/9789864340460>大話重構</a></li></ul></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><a class=tag href=/tags/refactor/ rel=tag>Refactor</a></ul></div></footer><div><p>文章內容均為個人學習記錄、心得與認知，若任何謬誤或建議，歡迎直接留言討論，一同成長。</p></div><iframe class=LikeCoin src="https://button.like.co/in/embed/wosilee/button?referrer=https%3a%2f%2feanlee.github.io%2fpost%2fseries%2foptimize_code_quality%2fcoding_suggest%2f" height=200 width=100% frameborder=0></iframe>
<script src=/js/copy-code-clipboard.js></script></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/post/series/build_automated_deploy/foreword/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>從零開始建立自動化發佈的流水線(持續搬移中)</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/post/series/build_automated_deploy/cicd_concept/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>踏入 CI/CD 的世界 - 觀念篇</p></a></div></nav><section class=comments><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//eanblog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2022 伊恩軟體技術學習與分享.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>