<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>使用 Jenkins/Azure Pipeline 進行持續整合 - 伊恩的開發狂想</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7903108559996033" crossorigin=anonymous></script><meta name=description content="在介紹完 CI/CD 的觀念後，接著介紹如何使用 Azure Pipelines、如何在 Azure VM 架構 Jenkins，以及 Jenkins 與 repository 的串接方式，以便持續整合(Continuous integration, CI)"><meta property="og:title" content="使用 Jenkins/Azure Pipeline 進行持續整合"><meta property="og:description" content="在介紹完 CI/CD 的觀念後，接著介紹如何使用 Azure Pipelines、如何在 Azure VM 架構 Jenkins，以及 Jenkins 與 repository 的串接方式，以便持續整合(Continuous integration, CI)"><meta property="og:type" content="article"><meta property="og:url" content="https://eandev.com/post/series/build-automated-deploy/ci-azure-pipeline-and-jenkins/"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-01-16T00:08:36+08:00"><meta property="article:modified_time" content="2023-06-28T10:10:47+08:00"><meta itemprop=name content="使用 Jenkins/Azure Pipeline 進行持續整合"><meta itemprop=description content="在介紹完 CI/CD 的觀念後，接著介紹如何使用 Azure Pipelines、如何在 Azure VM 架構 Jenkins，以及 Jenkins 與 repository 的串接方式，以便持續整合(Continuous integration, CI)"><meta itemprop=datePublished content="2023-01-16T00:08:36+08:00"><meta itemprop=dateModified content="2023-06-28T10:10:47+08:00"><meta itemprop=wordCount content="702"><meta itemprop=keywords content="Azure,"><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 Jenkins/Azure Pipeline 進行持續整合"><meta name=twitter:description content="在介紹完 CI/CD 的觀念後，接著介紹如何使用 Azure Pipelines、如何在 Azure VM 架構 Jenkins，以及 Jenkins 與 repository 的串接方式，以便持續整合(Continuous integration, CI)"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap"><link rel=stylesheet href=/css/style.min.css><link rel="shortcut icon" href=/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-4HXSCXTZKZ"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4HXSCXTZKZ",{anonymize_ip:!1})}</script><link href=/css/syntax.min.css rel=stylesheet><link href=/css/copy-to-clipboard.min.css rel=stylesheet></head><body class=body><div class="container container--outer"><header class=header><div class=container><div class="logo logo--mixed"><a class=logo__link href=/ title=伊恩的開發狂想 rel=home><div class="logo__item logo__imagebox"><img class=logo__img alt=logo src=/img/placeholder.png></div><div class="logo__item logo__text"><div class=logo__title>伊恩的開發狂想</div><div class=logo__tagline>在知識大海中漂流的小船，不停追尋屬於自己的秘寶。專注於 .NET、雲端技術、系統架構、開發技巧的道、法、術。</div></div></a></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用 Jenkins/Azure Pipeline 進行持續整合</h1><div class="post__meta meta"><div class="meta__item-author meta__item"><svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>伊恩</span></div><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2023-01-16T00:08:36+08:00>2023-01-16</time>
<time class=meta__text datetime=2023-06-28T10:10:47+08:00>(Last Modified: 2023-06-28)</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/devops/ rel=category>DevOps</a></span></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#雲端運算簡介>雲端運算簡介</a><ul><li><a href=#五大特性>五大特性</a></li><li><a href=#四種部署模式>四種部署模式</a></li><li><a href=#三種服務>三種服務</a></li></ul></li><li><a href=#azure-簡介>Azure 簡介</a></li><li><a href=#jenkins>Jenkins</a><ul><li><a href=#架設-jenkins>架設 Jenkins</a></li><li><a href=#建立-ci-專案>建立 CI 專案</a></li><li><a href=#使用-webhook-主動通知-jenkins>使用 Webhook 主動通知 Jenkins</a></li></ul></li><li><a href=#azure-pipelines-on-azure-devops>Azure Pipelines on Azure Devops</a><ul><li><a href=#azure-pipelines-的建立>Azure PipeLines 的建立</a></li><li><a href=#azure-pipelinesyml>azure-pipelines.yml</a></li><li><a href=#azure-pipeline-執行畫面>Azure pipeline 執行畫面</a></li></ul></li><li><a href=#延伸閱讀>延伸閱讀</a></li></ul></nav></div></div><div class="content post__content clearfix"><blockquote><p><a href=https://ithelp.ithome.com.tw/users/20107551/ironman/1906>2019 iT 邦幫忙鐵人賽</a>文章補完計劃，<a href=https://eandev.com/post/series/build-automated-deploy/build-ci-cd-from-scratch/#持續整合>從零開始建立自動化發佈的流水線</a>合篇</p></blockquote><p>上一篇 <a href=https://eandev.com/post/series/build-automated-deploy/github-action-travis-ci/>使用 Travis CI/GitHub Action 進行持續整合</a> 已經介紹 Travis CI 與 GitHub Actions。</p><p>接著，來介紹 Azure Pipelines，以及如何把 Jenkins 架設在 Azure 的虛構機器上。</p><pre tabindex=0><code class=language-chat data-lang=chat>Eric: 前面介紹完 Travis CI/GitHub Actions。接下來，我們來聊聊最多人使用的 Jenkins。

吉米: Jenkins 有聽其他人提起過，不過一直沒有放在心上。但我記得 Jenkins 的設定有點復雜。而且，我是不是要再另外準備一台電腦，提供 Jenkins 使用？

Eric: 放心，這點我有想到，我們可以使用雲端服務來解決這個問題。因此，在 Jenkins 之前，先跟介紹一下 Azure 雲端服務平台。
</code></pre><h2 id=雲端運算簡介>雲端運算簡介</h2><p>近年來，常常聽到雲端運算這名詞，但到底怎麼才可以稱之為雲端運算呢？</p><p>依據美國國家技術標準局( National Institute of Standards and Technology, NIST) 所定義的 雲端運算，它具有 <code>五大特性</code>、<code>四種部署模式</code>、以及 <code>三種服務</code>。</p><h3 id=五大特性>五大特性</h3><ul><li><p>自助式隨需服務(On-demand self-service)</p><p>客戶可以依其需求索取計算資源(例如伺服器或儲存空間)，且整個過程是單方面自動化的，無須與資源提供者互動。</p></li><li><p>廣泛網路接取(Broad network access)</p><p>服務是經由網路提供，且有標準機制能讓不同的客戶端平台(如智慧型手機及筆電等)都可以使用。</p></li><li><p>共享資源池(Resource pooling)</p><p>服務者所提供的計算資源，例如儲存空間、網路頻寬、計算能力、虛擬機器數量等，可類比為一個大水池，能隨時依需要(重新)分配給不同平台的多個使用者。使用者不需了解資源的實體位置，只要有抽象概念即可(如資源是在哪個國家或哪個資料中心)</p></li><li><p>快速的彈性(Rapid elasticity)</p><p>計算資源不僅可以快速且有彈性地被提供或釋放，且對客戶而言，資源是取之不盡且可以恣意購買的。</p></li><li><p>可量測的服務(Measured service)</p><p>計算資源可依其所提供的服務特性被自動控管及最佳化。提供者與使用者雙方都可透明地監控資源使用情形。</p></li></ul><h3 id=四種部署模式>四種部署模式</h3><ul><li>公用雲</li><li>私有雲</li><li>社群雲</li><li>混合雲</li></ul><h3 id=三種服務>三種服務</h3><ul><li>基礎架構即服務 (Infrastructure as a Service, IaaS)</li><li>平台即服務 (Platform as a Service, PaaS)</li><li>軟體即服務 (Software as a Service, SaaS)</li></ul><p><figure><center><img src=images/cloud-models-iaas-paas-saas.jpg alt="IaaS v.s. PaaS v.s. SaaS"><figcaption>IaaS v.s. PaaS v.s. SaaS</figcaption></center></figure>圖示來源: <a href=https://dev.to/cloudtech/iaas-vs-paas-vs-saas-41d2>IaaS vs. PaaS vs. SaaS - DEV Community 👩‍💻👨‍💻</a></p><h2 id=azure-簡介>Azure 簡介</h2><p>Azure 是 Microsoft 近年來，大力推行的公有雲端服務平台。它提供了多種服務，讓用使用者自行選擇、組合與運用。</p><p><figure><center><img src=images/Azure.png alt="Windows Azure 介紹"><figcaption>Windows Azure 介紹</figcaption></center></figure>( 圖片來源: <a href=https://azure.microsoft.com/zh-tw/resources/infographics/azure/>Azure 官網</a>)</p><p>Azure 發展致今，服務內容己經横跨 <strong>運算</strong>、<strong>資料服務</strong>、<strong>應用程式服務</strong>、<strong>儲存</strong>、<strong>網路</strong> 等類型。</p><p>目前 Azure 為了讓更多人使用與體驗，提供 免費帳戶 讓大家有機會嘗試 Azure 豐富的服務內容。</p><p><figure><center><img src=images/microsoft-azure-index-2018.png alt="Azure on 2018"><figcaption>Azure on 2018</figcaption></center></figure>2019 年 Azure 首頁畫面</p><p><figure><center><img src=images/azure-index-2023.png alt="Azure on 2023"><figcaption>Azure on 2023</figcaption></center></figure>2023年 <a href=https://azure.microsoft.com/zh-tw>Azure 首頁</a>畫面</p><p>為了確保帳戶的有效性，在申請免費帳戶時，必需經過信用卡驗證的關卡。</p><h2 id=jenkins>Jenkins</h2><blockquote><p>📝 資訊補充 📝</p><p>在 2023 年<a href=https://www.jenkins.io/>Jenkins</a> 的首頁中，可以看到 Jenkins 手舉停戰的 Logo。這是因為烏克蘭戰爭仍在持續中。</p></blockquote><p><a href=https://www.jenkins.io/>Jenkins</a>，俗稱老爺爺，是目前擁有眾多使用者的 CI/CD 軟體之一。擁有許多套件可搭配使用，以支援不同的需求，自行搭配組合。</p><p>同時，它也是一個使用 Java 撰寫的開源專案，</p><p><figure><center><img src=images/jenkins_index.png alt="2019 年 Jenkins 首頁"><figcaption>2019 年 Jenkins 首頁</figcaption></center></figure></p><p><figure><center><img src=images/jenkins-index-2023.png alt="2023 年 Jenkins 首頁"><figcaption>2023 年 Jenkins 首頁</figcaption></center></figure></p><h3 id=架設-jenkins>架設 Jenkins</h3><h4 id=azure-vm-機器建立>Azure VM 機器建立</h4><p>為了在將 Jenkins 掛在 Azure 上，因此，採用 Azure 的 Linux <strong>虛擬機器</strong> 。<figure><center><img src=images/index_1.png alt=index_1><figcaption>index_1</figcaption></center></figure></p><p>在進入 Azure 的畫面後，直接到 Marketplace 中，找到 Jenkins 進行安裝。</p><p><figure><center><img src=images/market.png alt=market><figcaption>market</figcaption></center></figure></p><p>接下來就是進行一連續的設定動作。</p><p>筆者特別把建立過程中，遇到的問題，跟大家分享一下。</p><p><figure><center><img src=images/cloud_shell.png alt=cloud_shell><figcaption>cloud_shell</figcaption></center></figure></p><p>在 Linux 虛擬機器設定的步驟中，採用 <code>SSH 公開金鑰</code> 保護的機制。</p><p>筆者建立金鑰的方式，是使用 Azure 的 <code>Cloud Shell</code> 產生 SSH 金鑰。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 建立 SSL 金鑰</span>
</span></span><span style=display:flex><span>ssh-keygen
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 再從產生出來的金鑰中，取出公鑰。</span>
</span></span><span style=display:flex><span>cat xxxxxxx.pub
</span></span></code></pre></div><p><figure><center><img src=images/domain_name.png alt="domain name"><figcaption>domain name</figcaption></center></figure></p><p>接著，在進行網路相關設定時，Domain Name 有進行規則運算式的驗證，要注意一下。</p><p>全部都設定完成後，就是等 Azure 完成部署。</p><p><figure><center><img src=images/building.png alt=building><figcaption>building</figcaption></center></figure></p><p><figure><center><img src=images/vm.png alt=vm><figcaption>vm</figcaption></center></figure></p><h4 id=jenkins-設定>Jenkins 設定</h4><p>我們可以從虛擬機器中的 DNS 名稱，看到 Jenkins 所在的網站。</p><p>連到該網址後，因為伺服器是採用 SSH 金鑰的認證，所以無法直接使用網站。</p><p><figure><center><img src=images/remote_web.png alt=圖片20181026_022330><figcaption>圖片20181026_022330</figcaption></center></figure></p><p>依指示，在本機端輸入 SSH 指令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ssh -L 127.0.0.1:8080:localhost:8080 username@domainname.eastus.cloudapp.azure.com
</span></span></code></pre></div><p>username: 設定時，所輸入的名稱。</p><p>domainname: 虛擬機器網路設定時，所輸入的 domain name。</p><p><figure><center><img src=images/ssh_fail.png alt=ssh_fail><figcaption>ssh_fail</figcaption></center></figure></p><p>結果，訊息回傳 <code>Permission denied (publickey)</code> 的錯誤。</p><p>因為 Cloud Shell 產生出來的金鑰，儲存在 Azure 空間中，但本機端沒有金鑰資訊。資訊不對等，自然就會發生錯誤。</p><p>只要將 Azure 中的金鑰，下載放到本機端的 .ssh 資料夾中，就可以順利動作。</p><p><figure><center><img src=images/ssh_success.png alt=ssh_success><figcaption>ssh_success</figcaption></center></figure></p><p>接下來，就可以從 <a href=http://localhost:8080>http://localhost:8080</a> 進入 Jenkins。不過第一次登入，一定要進行 Unlock 的動作。</p><p><figure><center><img src=images/Jenkins_First.png alt=Jenkins_First><figcaption>Jenkins_First</figcaption></center></figure></p><p>指 Jenkins 指示，輸入指令，就可以取回密碼，完成 Jenkins 的初始設定。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo cat /var/lib/jenkins/secrets/initialAdminPassword
</span></span></code></pre></div><p><figure><center><img src=images/Jenkns_working.png alt=Jenkns_working><figcaption>Jenkns_working</figcaption></center></figure></p><p>看到這個畫面，就大功告成，完成安裝。</p><pre tabindex=0><code class=language-chat data-lang=chat>Eric:
  是不是比想像中的容易。

吉米:
  對啊，沒有想到 Microsoft 還有專門介紹如何在 Azure 上 架設 Jenkins。

Eric:
  我們己經順利的在 Azure 上架設 Jenkins，並成功啟用。接下來，試著用 Jenkins 將 GitHub、BitBucket 的 Repository 接起來。
  Azure Repos 的部份，就交給 Azure DevOps 內的 Azure Pipeline 負責。

吉米:
  了解，但使用 Jenkins 在串接的 GitHub、BitBucket 這兩個不同平台時，設定上的差異會很大嗎？

Eric:
  這部份倒是不用太擔心。
  基本上，越多人便用的平台，Jenkins 通常會出現針對那平台或功能的插件。
</code></pre><h3 id=建立-ci-專案>建立 CI 專案</h3><p>由於 GitHub、BitBucket、均是使用 Git 的做為版控的方式。</p><p>以 串接 BitBucket 為例，說明 Git Repository 要如何進行設定。</p><p>首先，按下建立新的 CI 專案後，會出現專案的設定畫面。選擇 <code>Free-Style 軟體專案</code>。</p><p>直接移到原始碼管理，將 Repository 的位置填入，然後在 <strong>Credentials 中，選擇或新增 所使用 Repository 的帳密</strong>。以便 Jenkins 可以成功進入 private repository ，並取回資料。</p><p><figure><center><img src=images/Add-project.png alt="add projec"><figcaption>add projec</figcaption></center></figure></p><p><figure><center><img src=images/jenkins-bitbucket-create.png alt=bitbucket_create><figcaption>bitbucket_create</figcaption></center></figure></p><p>Repository 的設定只要出錯，建置的結果必定失敗。若去看建置失敗的原因，就會看到 git fetch 失敗。</p><p><figure><center><img src=images/jenkins-bitbucket-result.png alt=BitBucket_result><figcaption>BitBucket_result</figcaption></center></figure></p><p>設定到這邊，Jenkins 已經可以主動跟 Repository 取回資料，進行 CI 的行為。但無法在 Repository 異動的第一時間，得知 Repository 是任何變更，需要重新執行 CI 動作。</p><p>因此，一定要到 Repository 的平台上，設定 <code>webhook</code>，以便發生版本變更的同時，立即通知 Jenkins 進行 CI。</p><pre tabindex=0><code class=language-chat data-lang=chat>Eric:
  前面只是單純針對 Git 版控的 Repository 進行通用設定，但是 GitHub、BitBucket 這些被常用的平台，有好心人士公開專用的插件。
</code></pre><h3 id=使用-webhook-主動通知-jenkins>使用 Webhook 主動通知 Jenkins</h3><p>所以要到 Repository 的平台上，設定 <code>webhook</code>，讓 Repository 知道，當發生版本變更時，通知 Jenkins 進行 CI。</p><h4 id=github-plug-in>GitHub plug-in</h4><p>在最新版本的 Jenkins，己經預設安裝 <code>Github Plugin</code> 這個插件。所以在專案的 <code>組態</code> 中，看到 <code>GitHub projects</code>、<code>GitHub hook trigger for GITScm polling</code> 這兩個項目。</p><p><figure><center><img src=images/Jenkins_plugin_github.png alt=Jenkins_plugin_github><figcaption>Jenkins_plugin_github</figcaption></center></figure></p><p>勾選 GitHub Projects 後，專案選單中，會出現 <code>GitHub</code> 。點選後，會直接轉跳到 GitHub 網址。</p><p>勾選 GitHub hook trigger for GIT trigger for GITScm polling，則是出現 <code>GitHub Hook Log</code>。</p><p><figure><center><img src=images/Jenkins_plugin_github_selection.png alt=Jenkins_plugin_github_selection><figcaption>Jenkins_plugin_github_selection</figcaption></center></figure></p><p>但是這樣還是收不到，記得到 GitHub 設定 Webhook。</p><pre tabindex=0><code class=language-url data-lang=url>{jenkins網址}\github-webhook
</code></pre><h2 id=azure-pipelines-on-azure-devops>Azure Pipelines on Azure Devops</h2><pre tabindex=0><code class=language-chat data-lang=chat>Eric: 前面花了很長的時間，說明 Jenkins 設定與支援 GitHub、BitBucket 等 Git Repository。接下來，來聊聊 Azure DevOps 當中的 PipeLines。

吉米: Pipelines？

Eric: Microsoft 將原本 VSTS 當中，所有與 CI/CD 相關功能，統整於 Azure Pipelines。

吉米: 了解。

Eric: 我們先來聊聊 Azure Pipelines 對自家產品 Azure Repositories 的支援與設定。
</code></pre><h3 id=azure-pipelines-的建立>Azure PipeLines 的建立</h3><p><figure><center><img src=images/azure-devops-project-index.png alt="Azure Pipeline 的建置頁面"><figcaption>Azure Pipeline 的建置頁面</figcaption></center></figure></p><p>選取 Pipelines 的 Builds 後，會看到工作清單。但因為目前沒有任何資料，所以直接進入<code>建立 pipeline</code> 的容量。</p><p><figure><center><img src=images/azure-pipeline-repo-source.png alt="選擇 Code 的來源"><figcaption>選擇 Code 的來源</figcaption></center></figure></p><p>選擇 Azure Repository 後，如果該 Repository 內有資料，會列出 Repository 清單。</p><p><figure><center><img src=images/azure-pipeline-select-repos.png alt="選擇 Azure Pipeline 使用的 Repository"><figcaption>選擇 Azure Pipeline 使用的 Repository</figcaption></center></figure></p><p>如果選取的 Repository 內己經有資料，Azure Pipeline 會自動分析，並建立 yml 檔。</p><p><figure><center><img src=images/azure-pipeline-yaml.png alt="Azure Pipeline 使用的 YAML 檔"><figcaption>Azure Pipeline 使用的 YAML 檔</figcaption></center></figure></p><h3 id=azure-pipelinesyml>azure-pipelines.yml</h3><p>我們來看一下，Azure pipelines 自動建立出來的 yml 內容。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>pool</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>vmImage</span>: <span style=color:#e6db74>&#39;VS2017-Win2016&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>variables</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>solution</span>: <span style=color:#e6db74>&#39;**/*.sln&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>buildPlatform</span>: <span style=color:#e6db74>&#39;Any CPU&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>buildConfiguration</span>: <span style=color:#e6db74>&#39;Release&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>task</span>: <span style=color:#ae81ff>NuGetToolInstaller@0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>task</span>: <span style=color:#ae81ff>NuGetCommand@2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>restoreSolution</span>: <span style=color:#e6db74>&#39;$(solution)&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>task</span>: <span style=color:#ae81ff>VSBuild@1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>solution</span>: <span style=color:#e6db74>&#39;$(solution)&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>platform</span>: <span style=color:#e6db74>&#39;$(buildPlatform)&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>configuration</span>: <span style=color:#e6db74>&#39;$(buildConfiguration)&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>task</span>: <span style=color:#ae81ff>VSTest@2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>platform</span>: <span style=color:#e6db74>&#39;$(buildPlatform)&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>configuration</span>: <span style=color:#e6db74>&#39;$(buildConfiguration)&#39;</span>
</span></span></code></pre></div><p><code>azure-pipelines.yml</code> 的內容，其實還滿容易理解的。</p><ul><li><code>pool</code> 所使用的測試環境</li><li><code>varibale</code> 宣告 <code>task</code> 內的所使用的變數</li><li><code>steps</code> 真正進行動作用的地方，在 azure pipeline 內，將各個動作都視為 <code>task</code> 。</li></ul><p>Azure pipeline 動作時， 會依序執行 task，只要其中一個 task 失敗，就會直接中斷動作。並回報結果為失敗。</p><h3 id=azure-pipeline-執行畫面>Azure pipeline 執行畫面</h3><p>當 Repository 的程式碼有異動時，Azure Pipeline 就會依剛剛 <code>azure-pipelines.yml</code> 的指示，進行動作。</p><p>下面的圖為 Azure Pipelines 執行中的畫面。</p><p><figure><center><img src=images/azure-pipelines-exec-result.png alt=Azure_pipelines_result><figcaption>Azure_pipelines_result</figcaption></center></figure></p><pre tabindex=0><code class=language-chat data-lang=chat>Eric: 接下來，我們來聊聊 YAML 這個標註語言。
</code></pre><blockquote><p>📝 資訊補充 📝</p><p>YAML 標註語言的說明，請見 <a href=https://eandev.com/post/series/build-automated-deploy/yaml/>淺談 YAML 格式</a></p></blockquote><h2 id=延伸閱讀>延伸閱讀</h2><p>▶ Cloud</p><ul><li><a href=https://www.cloudopenlab.org.tw/ccipo_industryDefinition.do>雲端運算定義與範疇</a></li></ul><p>▶ Azure</p><ul><li><a href=https://docs.microsoft.com/zh-tw/azure/jenkins/>Jenkins on Azure 文件 - Jenkins | Microsoft Learn</a></li><li>hungys, <a href=https://ithelp.ithome.com.tw/articles/10157344>認識 Microsoft Azure</a></li><li><a href=https://docs.microsoft.com/en-us/azure/devops/release-notes/index>Azure DevOps Roadmap | Microsoft Learn</a></li><li><a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/yaml-schema?view=vsts&amp;tabs=schema">YAML schema reference | Microsoft Learn</a></li></ul><p>▶ Jenkins</p><ul><li><a href=https://support.cloudbees.com/hc/en-us/articles/224543927-GitHub-Integration-Webhooks>GitHub Integration: Webhooks – CloudBees Support</a></li><li><a href="https://www.youtube.com/watch?v=ke3f3rcRSc8">Configure Jenkins to Run Build Automatically on Code Push (youtube)</a></li><li><a href=https://dotblogs.com.tw/echo/2018/03/30/jenkins_plugin_msbuild>【Jenkins】外掛套件：MSBuild | 暴走的程式碼…</a></li><li><a href=https://blog.alexellis.io/3-steps-to-msbuild-with-docker/>3 Steps to MSBuild with Docker</a></li><li><a href=https://wiki.jenkins.io/display/JENKINS/Git+Plugin>Git | Jenkins plugin</a></li><li><a href=https://wiki.jenkins.io/display/JENKINS/Bitbucket+Plugin>Jenkins : Bitbucket Plugin</a></li><li><a href=https://wiki.jenkins.io/display/JENKINS/GitHub+Plugin>Jenkins : GitHub Plugin</a></li></ul></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><a class=tag href=/tags/azure/ rel=tag>Azure</a></ul></div></footer><hr><div><p>文章內容均為個人學習記錄、心得與認知，若任何謬誤或建議，歡迎直接留言討論，一同成長。</p></div><iframe class=LikeCoin src="https://button.like.co/in/embed/wosilee/button?referrer=https%3a%2f%2feandev.com%2fpost%2fseries%2fbuild-automated-deploy%2fci-azure-pipeline-and-jenkins%2f" height=200 width=100% frameborder=0></iframe>
<script src=/js/copy-code-clipboard.min.js></script></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/post/series/build-automated-deploy/github-action-travis-ci/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>使用 Travis CI/GitHub Action 進行持續整合</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/post/series/coding-skill/oop-practice/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>物件導向設計原則</p></a></div></nav><section class=comments><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//eanblog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2023 伊恩軟體技術學習與分享.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div></body></html>