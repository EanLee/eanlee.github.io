---
title: efcore
description: null
date: 2023-02-09T05:40:06.366Z
categories: null
tags: 
- EF Core
- Postgresql
keywords: 
- EF Core
- Postgresql
draft: true
---

> 🔖 長話短說 🔖
>

<!--more-->



`The Entity Framework tools version '6.0.8' is older than that of the runtime '7.0.1'. Update the tools for the latest features and bug fixes. See https://aka.ms/AAc1fbw for more information.`

當發生上述的訊息時，可以使用以下的指令來更新本機內的 EF Core 的 Tools 工具版本。

```shell
 dotnet tool update --global dotnet-ef
```

```shell
dotnet ef dbcontext scaffold <connect_string> Npgsql.EntityFrameworkCore.PostgreSQL

# 例子
dotnet ef dbcontext scaffold "Host=localhost;Database=habitsQuest;Username=postgres;Password=psg1234;Trust Server Certificate=true" Npgsql.EntityFrameworkCore.PostgreSQL
```

若是連線字串內的`Databas` 名稱與實際資料庫名稱大小寫不同，會發生找不到資料庫的錯誤。要特別注意。

若是想要指定產生出來的 `<DBContext.cs>` 放到指定位置，記得額加使用 `-o <Path>` 的指令。否則產生出來的位置與 .csproj 的位置相同。

```shell
dotnet ef dbcontext scaffold <connect_string> Npgsql.EntityFrameworkCore.PostgreSQL -o Models
```

若先前已經有產生過 `<DBContext>` 相關檔案，直接執行指令會出現 `The following file(s) already exist in directory 'c:\Codes\Repository\Models': HabitsQuestContext.cs,Quest.cs. Use the Force flag to overwrite these files.` 錯誤訊息。所以我們必須在指令加上 `-f`，告知 `ef dbcontext scaffold` 要覆寫先前已存在的檔案。

```shell
dotnet ef dbcontext scaffold <connect_string> Npgsql.EntityFrameworkCore.PostgreSQL -o Models -f
```

但要注意的是，上述的指令所產生出來 DBContext.cs 內，會含有連線字串，為了避免資訊外洩，務必記得移除，改用 configuration 注入的方式。

或者也可以使用以下的方式

```shell
# 待調整為 Postgresql 的方式
dotnet user-secrets init
dotnet user-secrets set ConnectionStrings:Chinook "Data Source=(localdb)\MSSQLLocalDB;Initial Catalog=Chinook"
dotnet ef dbcontext scaffold Name=ConnectionStrings:Chinook Microsoft.EntityFrameworkCore.SqlServer
```

在使用 `user-secrets` 後，系統會把機敏資料存放到....

## 延伸閱讀

▶ 站內文章

- [Npgsql Entity Framework Core Provider | Npgsql Documentation](https://www.npgsql.org/efcore/)
- [Entity Framework Core 工具參考 - EF Core | Microsoft Learn](https://learn.microsoft.com/zh-tw/ef/core/cli/)