---
title: 開發雜談 - 淺談 LOG 的設計與問題排查的重要性
description: null
tags:
  - 系統架構
categories:
  - 開發雜談
keywords:
  - log
date: 2023-01-16T07:43:34.840Z
draft: true
slug: 開發雜談-淺談-log-的設計與問題排查的重要性
---

在軟體開發中，有一個議題一直每一位開發人員都會遇到的，那就是 Log

常有人說 Log 太多會影響系統效能，也有人說 Log 記的太少，無法排除問題，只能通靈

<!--more-->

## Logs 的目的

## 如何設計 Logs

### 機敏性資料的問題

## Logging、Tracking

## 延伸閱讀

---

log 到底要多少才行

適量的 log 能幫助開發人員更容易地 debug 程式，並且能提供系統運行過程中的重要資訊。然而，過多的 log 可能會使程式變得複雜並增加系統運行的負擔。因此，適量的 log 是最好的選擇。

適量的 log 指的是在程式中選擇性地添加足夠的 log 以便追蹤問題，而不會使程式變得複雜或影響系統性能。例如，在程式的重要部分添加 log，或在出現問題時添加額外的 log 以便追蹤問題。

適量的 log 可以包括：

錯誤和例外狀況的記錄
關鍵部分程式的運行狀態
系統資源使用情況的記錄
用戶端請求和回應的記錄
最重要的是，要記得管理 logs，避免 logs 放太多導致系統過於龐大或容易被攻擊。

log 會影響效能
    file log, aduit log 
 與 正式流程解耦合, 使用非同步旳方式。

log 的目的, 回溯問題發生當下的資訊

log 的目的是記錄程式運行過程中的重要資訊，以便開發人員能夠追蹤問題並調整程式。通常可以用 log 來追蹤錯誤和例外狀況，檢查系統運行狀態，監控資源使用情況，記錄用戶端請求和回應等。

log 可以幫助開發人員：

快速定位問題
了解程式的運行情況
檢查系統的性能和穩定性
提供運維人員所需的資訊
支援監控和問題追蹤
除此之外，log 也可以被統計分析，以了解系統的使用情況，以改善服務品質。

常見 log 在實作上，會依嚴重程度會分為 Tracking, Info, waring, error 

log 的管理和監控是確保 log 能有效地幫助開發人員追蹤問題和改善程式性能的關鍵。以下是一些常見的 log 管理和監控作法：

- 適量地記錄 log: 確保不要記錄過多的 log，以免影響系統性能。只記錄重要的 log 以便追蹤問題。
- 分類 log: 將 log 分類為不同類型，例如錯誤 log、警告 log、跟蹤 log 等。這樣可以更容易地檢索和分析 log。
- 定期檢查 log: 定期檢查 log 以確保 log 的正確性和有效性。
- 儲存 log: 儲存 log 以便將來檢索和分析。一些 log 管理工具可以支援將 log 自動寫入資料庫或文件。
- 自動化監控：使用監控工具自動監控 log 以確保系統的正常運行。例如，可以設定警報當發生特定的錯誤或異常條件時。
- 安全性：確保 log 的安全性，避免資料外洩或被駭客竊取。
- 分析 log: 使用分析工具或自己寫程式對 log 進行分析，以了解系統的使用情況，改善服務品質。

這些作法可以幫助開發人員更有效地管理和監控 log，並更好地了解系統的運行情況，提高程式的健壯性和可靠性。此外，適當的 log 管理和監控作法也有助於改善系統的安全性，防止資料外洩和駭客入侵。

管理和監控 log，確保 log 能有效地幫助追蹤問題和提高程式性能。但是，還要看組織的需求，根據實際情況適量採取管理監控作法。

log 建議包含的資訊有那些？
log 建議包含的資訊可以根據程式運行的需求而有所不同，但通常可以考慮包含以下資訊：

- 時間戳: log 的發生時間。
- 事件類型: log 事件的類型，例如錯誤、警告、跟蹤等。
- 說明訊息：關於 log 事件的說明訊息。
- 堆疊追蹤：錯誤或例外狀況發生時的堆疊追蹤。
- 用戶身份：發生 log 事件的用戶身份。
- 請求資訊: log 事件相關的請求資訊，例如請求的 URL、參數、頭信息等。
- 系統資訊: log 事件相關的系統資訊，例如伺服器名稱、IP 地址、資源使用狀況等。
- 進程資訊：程式運行的進程資訊

這些資訊可以幫助開發人員更快速地定位問題和調整程式。

log 中建議包含的資訊可能會因需求而有所不同，但通常包含下列內容:

- 時間戳記：包含 log 記錄時間，以便追蹤問題和分析系統運行狀態。
- 級別：包含 log 的級別，如錯誤、警告、跟蹤等。這可以幫助開發人員快速定位問題。
- 事件 ID: 包含 log 事件的唯一 ID，以便追蹤問題。
- 使用者資訊：包含使用者名稱和 IP 地址等資訊，以便追蹤問題。
- 系統資訊：包含系統名稱、版本、運行環境等資訊，以便追蹤問題。
- 應用程式資訊：包含應用程式名稱、版本、模組名稱等資訊，以便追蹤問題。
- 詳細訊息：包含錯誤和例外狀況的詳細訊息，以便追蹤問題。
- 資源使用情況：包含系統資源使用情況，例如記憶體使用量、CPU 使用率等，以便監控系統性能。
- 請求 / 回應資訊：包含客戶端請求的 URL、參數、回應狀態碼等資訊，以便追蹤問題。

這些資訊可以幫助開發人員更快地定位問題，並有助於分析系統運行狀態。此外，還可以根據組織的需求來加入自己的需求，例如：資料庫的資訊，網路的狀態，等等.

log 稽核是指檢查和驗證 log 中的資訊是否正確和完整。通常，log 稽核的目的是確保 log 能夠追蹤問題和支援安全性管理。

以下是一些常見的 log 稽核作法:

- 檢查 log 格式：確保 log 中包含所需的資訊並按照預定格式記錄。
- 檢查 log 完整性：確保 log 中沒有遺漏的資訊，並檢查 log 中的資訊是否正確。
- 檢查 log 的時間戳：確保 log 中的時間戳是正確的，並檢查 log 中的時間戳是否與系統時間同步。
- 檢查 log 的安全性：確保 log 中的資訊不會被駭客竊取，並檢查 log 中的資訊是否加密。
- 異常偵測：異常偵測，如果發現有異常的 log，就需要立即處理。
- 定期稽核：定期稽核 log 以確保 log 的正確性和有效性。
- 建立稽核政策：建立稽核政策，確保所有 log 都符合政策。

這些作法可以確保 log 的正確性和完整性，並確保 log 能夠有效地幫助追蹤問題和支援安全性管理。


log metric 是指從 log 中提取的數據，用於監控和分析系統運行狀態。常見的 log metric 包括:

- 錯誤率：錯誤 log 數量除以總 log 數量的比率。
- 記憶體使用率：記憶體使用量除以總記憶體量的比率。
- CPU 使用率: CPU 使用時間除以總 CPU 時間的比率。
- 網路流量：網路流量的總量。
- 時間戳記：時間戳記的總量。
- 請求數量：網路請求數量的總量。
- 回應時間：請求回應時間的平均值或總和。
- 用戶在線時間：用戶在線時間的平均值或總和。
- 用戶行為：用戶行為的總量，例如點擊次數、停留時間等。
- 效能指標：效能指標的總量，例如 QPS、并發數量等。

這些 metric 可以幫助開發人員了解系統運行狀態，並支援監控和優化系統性能。此外，也可以根據組織需求對 log 數據進行自定義的計算。


logging, tracking, and metric 是三個有關於系統運行狀態的概念。

logging 是將系統運行狀態的訊息記錄下來的過程。通常，log 包含了系統運行狀態的詳細資訊，例如錯誤訊息、警告、跟蹤等。
tracking 是追蹤系統運行狀態的過程。通常，tracking 涉及到記錄系統運行狀態的資訊，例如使用者行為、網路請求、錯誤等。
metric 是從 log 和 tracking 中提取的數據，用於監控和分析系統運行狀態。通常，metric 涉及到指標，例如錯誤率、記憶體使用率、CPU 使用率、網路流量等。
總結來說，logging 是記錄系統運行狀態的過程，tracking 是追蹤系統運行狀態的過程，而 metric 是從 log 和 tracking 中提取的數據，用於監控和分析系統運行狀態。